import '@testing-library/jest-dom';
import { render } from '@testing-library/react';
import React from 'react';
import { MemoryRouter, Route } from 'react-router-dom';
import TroubleShootingNewPage from '../TroubleShootingNewPage';

// Create contexts
const ModalContext = React.createContext({
  additionalInfoSteps: [],
  setAdditionalInfoSteps: () => {},
  showModal: false,
  setShowModal: () => {}
});
const ConfigContext = React.createContext();
const ParamsContext = React.createContext();
const UiLoggerContext = React.createContext();

describe('TroubleShootingNewPage', () => {
  it('renders without crashing', () => {
    const modalValue = {
      additionalInfoSteps: [],
      setAdditionalInfoSteps: jest.fn(),
      showModal: false,
      setShowModal: jest.fn(),
      modalParams: {
        title: '',
        body: '',
        primaryButton: {},
        secondaryButton: {}
      },
      setModalParams: jest.fn()
    };

    const uiLoggerValue = {
      setPageDetails: jest.fn(),
      pageDetails: {}
    };

    const props = {
      functions: {
        handleTroubleShootingAction: jest.fn(),
        handleAction: jest.fn(),
        processTroubleShootingPage: jest.fn()
      },
      values: {
        troubleShootingInfo: {
          ddata: {
            output: {
              pageContent: {
                steps: []
              },
              navHist: []
            }
          }
        },
        landingInfo: {},
        symptom: {},
        selectedIssueOptionStep: '',
        thumbsDownSubmittedStep: false,
        analysis: { title: 'Test Analysis' },
        resolution: { title: 'Test Resolution' },
        currentPageId: 'test-page-id'
      }
    };

    render(
      <MemoryRouter initialEntries={['/test']}>
        <UiLoggerContext.Provider value={uiLoggerValue}>
          <ModalContext.Provider value={modalValue}>
            <ConfigContext.Provider value={{ 
              paramsDetails: { 
                channel: 'CARE',
                enableDelphiBannerIds: '',
                delphiSiteSurveySummaryIds: ''
              } 
            }}>
              <ParamsContext.Provider value={{ 
                paramsDetails: {
                  channel: 'CARE'
                } 
              }}>
                <Route>
                  {routeProps => <TroubleShootingNewPage {...props} {...routeProps} />}
                </Route>
              </ParamsContext.Provider>
            </ConfigContext.Provider>
          </ModalContext.Provider>
        </UiLoggerContext.Provider>
      </MemoryRouter>
    );
  });
});
